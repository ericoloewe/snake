var Model;!function(t){!function(t){t[t.right=0]="right",t[t.left=1]="left",t[t.up=2]="up",t[t.down=3]="down"}(t.Direction||(t.Direction={}));t.Direction}(Model||(Model={}));var Model;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t}();t.Pointer=e}(Model||(Model={}));var Model;!function(t){var e=function(){function t(){this.actual=0}return t.prototype.toString=function(){return"SCORE: "+this.actual},t}();t.Score=e}(Model||(Model={}));var Model;!function(t){var e=function(){function t(t,e){this.create_food(t,e)}return t.prototype.create_food=function(t,e){this.pointer={x:t,y:e}},t}();t.Food=e}(Model||(Model={}));var Model;!function(t){var e=function(){function e(){this.pointers=new Array,this.face=new t.Pointer(e.INITIAL_LENGTH,0),this.head=new t.Pointer(e.INITIAL_LENGTH-1,0),this.tail=new t.Pointer,this.before_tail=new t.Pointer(-1,0),this.score=new t.Score,this.create_snake(),this.direction=t.Direction.right}return Object.defineProperty(e,"INITIAL_LENGTH",{get:function(){return 5},enumerable:!0,configurable:!0}),e.prototype.create_snake=function(){this.pointers=new Array(new t.Pointer(0,0));for(var n=0;n<=e.INITIAL_LENGTH-1;n++)this.pointers.push(new t.Pointer(n,0));this.pointers.shift(),this.pointers.sort(function(t,e){return t.x<e.x?1:t.x>e.x?-1:0})},e}();t.Snake=e}(Model||(Model={}));var Model;!function(t){var e=function(){function e(){this.food=new t.Food,this.snake=new t.Snake,this.game_loop=void 0,this.own=null}return e.prototype.init=function(){var t=this;this.food.create_food(Math.round(Math.random()*this.width),Math.round(Math.random()*this.height)),this.paintArena(),this.paintSnake(),this.paintFood(),this.game_loop=setInterval(function(){t.paint()},50)},e.prototype.reinit=function(){var e=this;this.snake=new t.Snake,this.cleanArena(),this.paintSnake(),this.paintFood(),void 0!=typeof this.game_loop&&clearInterval(this.game_loop),this.game_loop=setInterval(function(){e.paint()},50)},e.prototype.paint=function(){this.snakeIsOut()||this.checkCollision()||(this.changePointers(),this.paintSnake(),this.checkDirection())},e.prototype.paintCell=function(t,e,n){void 0===n&&(n="activeSnake"),this.own.find(".y"+e+" .x"+t).addClass(n)},e.prototype.eraseCell=function(t,e,n){void 0===n&&(n="activeSnake"),this.own.find(".y"+e+" .x"+t).removeClass(n)},e.prototype.cleanArena=function(){this.own.find("tr td").removeClass("activeSnake"),this.own.find("tr td").removeClass("activeFood")},e.prototype.cleanSnake=function(t){void 0===t&&(t="activeSnake"),this.own.find("tr td").hasClass(t)&&this.own.find("tr td").removeClass(t)},e.prototype.cleanSnakeHead=function(t){void 0===t&&(t="activeSnakeHead"),this.own.find("tr td").hasClass(t)&&this.own.find("tr td").removeClass(t)},e.prototype.cleanFood=function(t){void 0===t&&(t="activeFood"),this.own.find("tr td").hasClass(t)&&this.own.find("tr td").removeClass(t)},e.prototype.paintArena=function(){for(var t="",e=0;e<this.height;e++){t+="<tr height='10' class='y"+e+"'>";for(var n=0;n<this.width;n++)t+="<td width='10' class='x"+n+"'></td>";t+="</tr>"}this.own.html(t)},e.prototype.paintFood=function(){this.cleanFood(),this.paintCell(this.food.pointer.x,this.food.pointer.y,"activeFood"),$(".score").text(this.snake.score.toString())},e.prototype.paintSnake=function(){var t=this;this.own.find("tr td.activeSnake").length===this.snake.pointers.length?this.mosey():(this.cleanSnake(),this.snake.pointers.forEach(function(e){t.paintCell(e.x,e.y)})),this.paintSnakeHead()},e.prototype.paintSnakeHead=function(){this.cleanSnakeHead(),this.paintCell(this.snake.head.x,this.snake.head.y,"activeSnakeHead")},e.prototype.clearLastCell=function(){this.eraseCell(this.snake.before_tail.x,this.snake.before_tail.y)},e.prototype.checkDirection=function(){this.snake.direction==t.Direction.left?this.snake.face.x--:this.snake.direction==t.Direction.up?this.snake.face.y--:this.snake.direction==t.Direction.down?this.snake.face.y++:this.snake.face.x++},e.prototype.snakeIsOut=function(){return-1==this.snake.head.x||this.snake.head.x==this.width||-1==this.snake.head.y||this.snake.head.y==this.height},e.prototype.snakeEat=function(){return this.snake.head.x==this.food.pointer.x&&this.snake.head.y==this.food.pointer.y},e.prototype.checkCollision=function(){var t=this,e=!1;return this.snake.pointers.forEach(function(n){n.x==t.snake.face.x&&n.y==t.snake.face.y&&(e=!0)}),e},e.prototype.mosey=function(){this.clearLastCell(),this.paintCell(this.snake.face.x,this.snake.face.y)},e.prototype.changePointers=function(){this.snakeEat()?(this.snake.score.actual++,this.food.create_food(Math.round(Math.random()*this.width),Math.round(Math.random()*this.height)),this.paintFood()):this.snake.before_tail=this.snake.pointers.pop(),this.snake.head=new t.Pointer(this.snake.face.x,this.snake.face.y),this.snake.tail=this.snake.pointers[this.snake.pointers.length-1],this.snake.pointers.unshift(this.snake.head)},e}();t.Arena=e}(Model||(Model={}));var arena=new Model.Arena;$(document).ready(function(){arena.cellWidth=10,arena.own=$(".arena"),arena.width=50,arena.height=40,arena.init(),$(document).keydown(function(t){var e=t.which;37==e&&arena.snake.direction!=Model.Direction.right?arena.snake.direction=Model.Direction.left:38==e&&arena.snake.direction!=Model.Direction.down?arena.snake.direction=Model.Direction.up:39==e&&arena.snake.direction!=Model.Direction.left?arena.snake.direction=Model.Direction.right:40==e&&arena.snake.direction!=Model.Direction.up&&(arena.snake.direction=Model.Direction.down)})});